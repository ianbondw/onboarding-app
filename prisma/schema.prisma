// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model OnboardingSession {
  id        String           @id @default(cuid())
  token     String           @unique
  status    OnboardingStatus @default(IN_PROGRESS)
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  sections SectionData[]
  uploads  Upload[]
}

model SectionData {
  id        String            @id @default(cuid())
  session   OnboardingSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  sessionId String
  name      String
  data      Json
  updatedAt DateTime          @updatedAt

  @@unique([sessionId, name])
}

model Upload {
  id        String            @id @default(cuid())
  session   OnboardingSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  sessionId String
  filename  String
  mimeType  String
  size      Int
  url       String
  createdAt DateTime          @default(now())
}

enum OnboardingStatus {
  IN_PROGRESS
  COMPLETED
}
